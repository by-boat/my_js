<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /**
       * æ‰‹å†™ new å…³é”®å­—æ‰€åšçš„äº‹æƒ…
       * 1. åˆ›å»ºä¸€ä¸ªå¯¹è±¡
       * 2. è¯¥å¯¹è±¡çš„éšå¼åŽŸåž‹æŒ‡å‘æž„é€ å‡½æ•°çš„åŽŸåž‹å¯¹è±¡
       * 3. æ‰§è¡Œæž„é€ å‡½æ•°ï¼Œå¹¶æ”¹å˜å…¶thisæŒ‡å‘
       * 4. è¿”å›žå¯¹è±¡
       */
      function new_(fn) {
        if (typeof fn !== "function") throw "fn is not a function";
        if (!fn.prototype) throw new Error("fn is not constructor");
        const obj = {};
        obj.__proto__ = fn.prototype;
        fn.call(obj);
        return obj;
      }

      function aa() {
        this.a = 1;
      }
      const bb = () => {};

      const shili1 = new aa();
      const shili2 = new_(aa);
      console.log(
        "ðŸš€ ~ file: æ‰‹å†™newå…³é”®å­—æ­¥éª¤.html ~ line 23 ~ shili1",
        shili1
      );
      console.log(
        "ðŸš€ ~ file: æ‰‹å†™newå…³é”®å­—æ­¥éª¤.html ~ line 23 ~ shili1",
        shili2
      );
    </script>
  </body>
</html>
