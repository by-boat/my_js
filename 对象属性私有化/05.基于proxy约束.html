<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /**
       * ä½¿ç”¨proxyåŠ«æŒå¯¹è±¡å±æ€§çš„getï¼Œsetï¼ŒownKeysï¼Œå½“å±æ€§ä»¥_å¼€å¤´çš„å°±ä¸è®©è®¿é—®
       * è¿™æ ·å°±å®ç°äº†ä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§çš„ç§æœ‰åŒ–
       *
       * æˆ‘ä»¬é€šè¿‡ new Proxy æ¥ç»™ dong å®šä¹‰äº† getã€setã€ownKeys çš„ handlerï¼š
       * get: å¦‚æœä»¥ä¸‹åˆ’çº¿ _ å¼€å¤´å°±è¿”å›ç©ºï¼Œå¦åˆ™è¿”å›ç›®æ ‡å¯¹è±¡çš„å±æ€§å€¼ target[prop]ã€‚
       * set: å¦‚æœä»¥ä¸‹åˆ’çº¿ _ å¼€å¤´å°±ç›´æ¥è¿”å›ï¼Œå¦åˆ™è®¾ç½®ç›®æ ‡å¯¹è±¡çš„å±æ€§å€¼ã€‚
       * ownKeys: è®¿é—® keys æ—¶ï¼Œè¿‡æ»¤æ‰ç›®æ ‡å¯¹è±¡ä¸­ä¸‹åˆ’çº¿å¼€å¤´çš„å±æ€§å†è¿”å›ã€‚
       */
      const person = function (name) {
        function Person(name) {
          this._name = name;
        }
        const person = new Proxy(new Person(name), {
          get(target, prop) {
            if (prop.startsWith("_")) {
              throw new Error(prop + " ä¸ºç§æœ‰å±æ€§ï¼");
              return;
            }
            return target[prop];
          },
          set(target, prop, value) {
            if (prop.startsWith("_")) {
              return;
            }
            target[prop] = value;
          },
          ownKeys(target, prop) {
            return Object.keys(target).filter((key) => !key.startsWith("_"));
          },
        });
        return person;
      };

      const person1 = person("å½¦ç¥–");
      const person2 = person("å† å¸Œ");
      console.log(
        "ğŸš€ ~ file: 05.åŸºäºproxyçº¦æŸ.html ~ line 35 ~ person1",
        person1._name
      );
      console.log(
        "ğŸš€ ~ file: 05.åŸºäºproxyçº¦æŸ.html ~ line 35 ~ person1",
        person2
      );
    </script>
  </body>
</html>
